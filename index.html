<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NewsNow - Real-Time News Portal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background: #f9fafb;
      font-family: "Poppins", sans-serif;
    }
    header {
      background: #0d6efd;
      color: #fff;
      padding: 1rem;
      text-align: center;
    }
    .news-card {
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.2s ease;
    }
    .news-card:hover {
      transform: translateY(-3px);
    }
    .news-image {
      height: 200px;
      object-fit: cover;
    }
  </style>
</head>
<body>
  <header>
    <h1>üì∞ NewsNow - Real-Time News Portal</h1>
    <p>Stay updated with breaking headlines around the world</p>
  </header>

  <div class="container my-4">
    <div class="row mb-3">
      <div class="col-md-4">
        <select id="country" class="form-select">
          <option value="us" selected>United States</option>
          <option value="in">India</option>
          <option value="gb">United Kingdom</option>
          <option value="au">Australia</option>
          <option value="ca">Canada</option>
        </select>
      </div>
      <div class="col-md-4">
        <select id="category" class="form-select">
          <option value="general" selected>General</option>
          <option value="business">Business</option>
          <option value="technology">Technology</option>
          <option value="sports">Sports</option>
          <option value="entertainment">Entertainment</option>
          <option value="health">Health</option>
          <option value="science">Science</option>
        </select>
      </div>
      <div class="col-md-4 text-end">
        <button id="refreshBtn" class="btn btn-primary w-100">üîÑ Refresh News</button>
      </div>
    </div>

    <div id="newsContainer" class="row g-4"></div>
  </div>

  <script>
    const API_KEY = "f22114235da84280932f760af66b06cc";
    const newsContainer = document.getElementById("newsContainer");
    const countrySelect = document.getElementById("country");
    const categorySelect = document.getElementById("category");
    const refreshBtn = document.getElementById("refreshBtn");

    async function fetchNews() {
      const country = countrySelect.value;
      const category = categorySelect.value;

      const proxyUrl = "https://api.allorigins.win/get?url=";
      const apiUrl = `https://newsapi.org/v2/top-headlines?country=${country}&category=${category}&apiKey=${API_KEY}`;

      newsContainer.innerHTML = `<p class='text-center text-muted mt-4'>Loading news...</p>`;

      try {
        const res = await fetch(proxyUrl + encodeURIComponent(apiUrl));
        const data = await res.json();
        const parsed = JSON.parse(data.contents);
        displayNews(parsed.articles);
      } catch (error) {
        console.error("Error fetching news:", error);
        newsContainer.innerHTML = `<p class='text-danger text-center mt-4'>‚ö†Ô∏è Failed to load news. Please try again later.</p>`;
      }
    }

    function displayNews(articles) {
      if (!articles || articles.length === 0) {
        newsContainer.innerHTML = `<p class='text-center text-muted mt-4'>No news found for this category.</p>`;
        return;
      }

      newsContainer.innerHTML = articles
        .map(
          (article) => `
          <div class="col-md-4">
            <div class="card news-card h-100">
              <img src="${article.urlToImage || 'https://via.placeholder.com/400x200?text=No+Image'}" class="card-img-top news-image" alt="News image">
              <div class="card-body">
                <h5 class="card-title">${article.title || "Untitled"}</h5>
                <p class="card-text">${article.description || "No description available."}</p>
                <a href="${article.url}" target="_blank" class="btn btn-primary btn-sm">Read More</a>
              </div>
            </div>
          </div>
        `
        )
        .join("");
    }

    refreshBtn.addEventListener("click", fetchNews);
    countrySelect.addEventListener("change", fetchNews);
    categorySelect.addEventListener("change", fetchNews);

    // Auto-refresh every 5 minutes
    setInterval(fetchNews, 300000);

    // Load on startup
    fetchNews();
  </script>
</body>
</html>
